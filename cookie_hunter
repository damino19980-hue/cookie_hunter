#!/usr/bin/env python3
import os
import json
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from cryptography.fernet import Fernet

class CookieHunter:
def init(self, target_url):
self.target_url = target_url
self.key = Fernet.generate_key()
self.cipher = Fernet(self.key)
self.driver = self._init_driver()

def _init_driver(self):
    options = Options()
    options.add_argument("--headless")
    options.add_argument("--disable-gpu")
    options.add_argument("--no-sandbox")
    options.binary_location = "/usr/bin/chromium"
    return webdriver.Chrome(options=options)

def get_cookies(self):
    try:
        self.driver.get(self.target_url)
        cookies = self.driver.get_cookies()
        return {
            "status": "success",
            "url": self.target_url,
            "cookies": [
                {
                    "name": c["name"],
                    "value": self.cipher.encrypt(c["value"].encode()).decode(),
                    "domain": c["domain"]
                } for c in cookies
            ],
            "decryption_key": self.key.decode()
        }
    except Exception as e:
        return {
            "status": "error",
            "message": str(e)
        }
    finally:
        self.driver.quit()
